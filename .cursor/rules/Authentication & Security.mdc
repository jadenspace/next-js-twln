# TWLN 프로젝트 인증 및 보안 가이드

## 인증 시스템 아키텍처

### Supabase Auth 기반 인증

- 이메일/비밀번호 인증 방식
- JWT 토큰 기반 세션 관리
- 자동 토큰 갱신 및 만료 처리
- 클라이언트/서버 사이드 인증 동기화

### 관리자 승인 시스템

- 사용자 회원가입 후 관리자 승인 필요
- 승인 상태는 데이터베이스에서 관리
- 미승인 사용자는 로그인 차단
- 관리자 권한 분리 및 관리

## 보안 정책

### Row Level Security (RLS)

- Supabase RLS 정책 적용
- 사용자별 데이터 접근 제어
- 테이블별 보안 정책 설정
- 관리자 권한 분리

### 미들웨어 보안

- 라우트별 인증 체크
- 인증되지 않은 사용자 리다이렉트
- 개발 환경에서 인증 우회 가능
- 보안 헤더 설정

### 환경 변수 보안

- 민감한 정보는 환경 변수로 관리
- 개발/프로덕션 환경 분리
- 환경 변수 검증 및 기본값 설정
- 보안 키 로테이션 정책

## 인증 플로우

### 회원가입 플로우

1. 사용자 이메일/비밀번호 입력
2. Supabase Auth를 통한 계정 생성
3. 관리자 승인 대기 상태
4. 승인 후 서비스 이용 가능

### 로그인 플로우

1. 이메일/비밀번호 인증
2. 승인 상태 확인
3. 인증 성공 시 세션 생성
4. 미들웨어를 통한 라우트 보호

### 로그아웃 플로우

1. Supabase 세션 무효화
2. 클라이언트 상태 초기화
3. 쿼리 캐시 클리어
4. 로그인 페이지로 리다이렉트

## 권한 관리

### 사용자 권한

- 일반 사용자: 기본 기능 이용
- 승인된 사용자: 전체 기능 이용
- 미승인 사용자: 제한된 기능만 이용

### 관리자 권한

- 사용자 승인/거부
- 사용자 목록 조회
- 시스템 설정 관리
- 로그 및 모니터링

## 보안 모범 사례

### 클라이언트 사이드 보안

- 민감한 정보는 클라이언트에 저장하지 않음
- XSS 방지를 위한 입력 검증
- CSRF 토큰 활용
- 보안 헤더 설정

### 서버 사이드 보안

- SQL 인젝션 방지
- 입력 데이터 검증 및 살균
- 레이트 리미팅 적용
- 로그 모니터링 및 알림

### 데이터 보호

- 개인정보 암호화 저장
- 데이터 백업 및 복구
- 데이터 접근 로그 기록
- 개인정보 보호 정책 준수

## 에러 처리 및 보안

### 인증 에러 처리

- 인증 실패 시 명확한 에러 메시지
- 계정 잠금 정책
- 비밀번호 재설정 기능
- 보안 이벤트 로깅

### 보안 이벤트 모니터링

- 비정상적인 접근 시도 감지
- 로그인 실패 모니터링
- 의심스러운 활동 알림
- 보안 인시던트 대응 절차
